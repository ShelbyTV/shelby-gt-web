<%
  var messageJSON;
  if (message) {
    messageJSON = message.toJSON();
    messageJSON.text = message.getText();
  } else {
    /*
      if there is no message, create something that looks like
      a message so that the frame displays who created it and when
    */
    var creator = frame.get('creator');
    messageJSON = {
      created_at : frame.get('created_at'),
      realname : (creator ? creator.get('name') : ""),
      nickname : (creator ? creator.get('nickname') : ""),
      user_id : (creator? creator.id : ""),
      user_image_url : libs.shelbyGT.viewHelpers.user.avatarUrl(creator)
    };
  }
%>
<blockquote class="media_module">
  <a href="#" onclick="return false;" class="media_image">
    <span class="image_module xuser-avatar" style="background-image: url(<%= messageJSON.user_image_url %>);" role="img">
      <img src="<%= messageJSON.user_image_url %>" class="visuallyhidden" title="<%= messageJSON.nickname %>" alt="<%= messageJSON.nickname %>">
    </span>
  </a>
  <div class="media_body">
    <p class="xuser-data">
      <strong><%= messageJSON.realname %></strong>
      <span class="xuser-data-timestamp">
        <%= messageJSON.created_at %>
      </span>
    </p>
    <p>
      <%= messageJSON.text %>
    </p>
    <div class="xframe-subline">
      <a class="xframe-link conversation-message-reply js-message-reply js-track-event" href="#" data-ga_category="Message" data-ga_action="Click reply" data-ga_label="<%= user.get('nickname') %>" data-reply_to="<%= messageJSON.nickname %>">Reply</span>
    </div>
  </div>
</blockquote><!-- eo .media_module-->
<script>
  <% if ("production" == Rails.env or "staging" == Rails.env) %>
    //Track loading of landing page separate from loading of app -->
    var shortLink = $.getUrlParam('awesm');
    if (typeof viaShortLink != 'undefined') { shortLink = 'via Short Link: ' + shortLink; }
    else { shortLink = "Direct"; }
    var _gaq=[['_setAccount','<%= Settings::GoogleAnalytics.code %>'],['_setDomainName','shelby.tv'],['_setCustomVar', 1, 'Visit Type', shortLink, 3],['_trackPageview']];
    (function(d,t){var g=d.createElement(t),s=d.getElementsByTagName(t)[0];
    g.src=('https:'==location.protocol?'//ssl':'//www')+'.google-analytics.com/ga.js';
    s.parentNode.insertBefore(g,s);}(document,'script'));
  <% end %>

  <% if Rails.env == 'production' %>
    var _kmq = _kmq || [];
    var _kmk = _kmk || '9b8c2d291a85a66412fc8c0085125194646fd7a6';
    function _kms(u){
      setTimeout(function(){
        var d = document, f = d.getElementsByTagName('script')[0],
        s = d.createElement('script');
        s.type = 'text/javascript'; s.async = true; s.src = u;
        f.parentNode.insertBefore(s, f);
      }, 1);
    }
    _kms('//i.kissmetrics.com/i.js');
    _kms('//doug1izaerwt3.cloudfront.net/' + _kmk + '.1.js');

    var action = "Visit "+shelbyTrackingCategory;
    var shortLink = $.getUrlParam('awesm');
    if (typeof shortLink != 'undefined') {  action += ' via Short Link'; }
    else { shortLink = null; }
    _kmq.push(['record', action, {shortLink: shortLink}]);
  <% end %>

  $(document).ready(function(){
    try {
      _gaq.push(['_trackEvent', 'Landing Page', 'Visit']);
    } catch(e) {}

    var $buttonMain   = $('.js-cta'),
        $buttonHeader = $('.js-cta-header'),
        $header       = $('.js-header');

    $(window).on('scroll',function(e){
      if($buttonMain.offset().top + $buttonMain.height() - $(this).scrollTop() - $header.height() > 0) {
        $buttonHeader.toggleClass('button_transparent',true);
      } else {
        $buttonHeader.toggleClass('button_transparent',false);
      }
    });
  });
</script>

<!doctype html>
<!--[if IE 8]>    <html class="no-js lt-ie9" lang="en"> <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en"> <!--<![endif]-->

<% # if we got any meta tag info from request display it, otherwise just render head normally %>
<head prefix="og: http://ogp.me/ns# fb: http://ogp.me/ns/fb# shelbytv: http://ogp.me/ns/fb/shelbytv#">
  <%= render :partial => "meta_info", :locals => { :info => @meta_info } %>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
  <title>
    <%= render :partial => "title_tag", :locals => { :meta_info => @meta_info} %>
  </title>
  
  <meta name="viewport" content="width=device-width">
  <head profile="http://www.w3.org/2005/10/profile">
  <link rel="icon"type="image/png" href="/favicon.png">
  <%= include_stylesheets :common %>
  <%= include_javascripts :common %>
  <!--[if lt IE 9]><link href="/stylesheets/png.css" media="screen, projection" rel="stylesheet" type="text/css" /><![endif]-->  
</head>

<body class="email-gate">
  <!-- Prompt IE 6 users to install Chrome Frame. Remove this if you support IE 6.
       chromium.org/developers/how-tos/chrome-frame-getting-started -->
  <!--[if lt IE 7]><p class=chromeframe>Your browser is <em>ancient!</em> <a href="http://browsehappy.com/">Upgrade to a different browser</a> or <a href="http://www.google.com/chromeframe/?redirect=true">install Google Chrome Frame</a> to experience this site.</p><![endif]-->

<% if flash[:error] == "401" %>
	<h1>Please sign in again</h1>
	<h2>Sorry for the inconvenience, but your session expired (we do this for security)</h2>
<% end %>

<div class="content-wrapper <%= 'with-embed' if @video_embed %>">
	
	<% if @meta_info[:video_embed] %>
		<div class="embed-gate-wrapper">
			<%=raw @meta_info[:video_embed] %>
			<h1 style="margin: 15px 0 10px;">Your friend discovered this video with Shelby.tv</h1>
			<h2>
				You have a very cool friend, because they have access to Shelby GT, our latest version, which delivers personalized streams of video curated by your friends. 
			</h2>
			<h3 style="margin: 10px 0 0 0;">
				P.S. "GT" is just the project code name. Our CTO really likes cars.
			</h3>
		</div>
	<% end -%>

	<div class="email-gate-wrapper <%= 'with-embed' if @meta_info[:video_embed] %>">
	  <header class="email-gate-header clearfix">
	    <h1 class="email-gate-logo ir">
	      Shelby.tv
	    </h1>
	    <p class="email-gate-slogan">
	      An amazing way to <br> discover and enjoy videos.
	    </p>
	  </header>

	  <form class="email-gate-login">
	    <button class="email-gate-login-button">
	      Login
	    </button>


	    <fieldset class="email-gate-networks">
	      <a class="email-gate-networks-twitter" href="<%= "#{Settings::ShelbyAPI.url}/auth/twitter" %>">
	        Log In with Twitter
	      </a>   
	      <a class="email-gate-networks-facebook" href="<%= "#{Settings::ShelbyAPI.url}/auth/facebook" %>">
	        Log In with Facebook
	      </a>
	    </fieldset>
	  </form>

		<% if @show_error %>
			<div class="no-access">
				<h1>Sorry, you don't have access to Shelby GT just yet.</h1>
				<h2>But we're working hard to get you in!</h2>
	      <h2 class="detour">In the meantime, visit our <a href="http://shelby.tv">current website</a>!</h2>
			</div>
		<% elsif @has_access_token %>
			<div class="private-beta-access">
				<h1>Welcome the Shelby GT private beta!</h1>
				<h2>Sign up, we don't auto-post anything:</h2>
				<p class="login">
					<a class="email-gate-networks-twitter" href="<%= "#{Settings::ShelbyAPI.url}/auth/twitter" %>">
		        Sign Up with Twitter
		      </a>   
		      <a class="email-gate-networks-facebook" href="<%= "#{Settings::ShelbyAPI.url}/auth/facebook" %>">
		        Sign Up with Facebook
		      </a>
				</p>
			</div>
		<% elsif @gt_enabled_redirect %>
			<div class="private-beta-access">
				<h1>You're part of the Shelby GT private beta!</h1>
				<h2>Use the login at the top right of this page to enter.</h2>
			</div>
		<% else %>
			<form class="email-gate-signup">
		    <legend class="email-gate-caption">
		      Shelby GT is currently in a private beta.<br />
					If you want in on the action, let us know!
		    </legend>
		    <label for="email-gate-email" class="email-gate-label">
		      Email
		    <input type="email" id="email-gate-email" class="email-gate-email" name="email" placeholder="Where can we reach you?" />
		    </label>
  
		    <label for="email-gate-code" class="email-gate-label">
		      Priority Code
		    <input type="text" id="email-gate-code"  class="email-gate-code" name="priority_code" placeholder="Are you special?" />
		    </label>
  
		    <button type="submit" class="email-gate-signup-submit">
		      Submit
		    </button>
		  </form>

			<div class="email-gate-thank-you">
				<h1>Thanks for the info! We'll let you know when Shelby GT is revved and ready.</h1>
				<h2>Can't wait? Watch videos now on <a href="http://shelby.tv">Shelby 1.0</a></h2>
			</div>
		<% end %>

	</div><!-- eo email-gate-wrapper -->
</div><!-- eo content-wrapper -->

	<script>
		$(function(){
			$('.email-gate-login-button').click(function(){
				$('.email-gate-networks').toggle();
				return false;
			});
			
			$('.email-gate-signup').submit(function() {
				$.post('//api.gt.shelby.tv/v1/gt_interest', $(this).serialize(), function(data) {
					$('.email-gate-signup').hide()
					$('.email-gate-thank-you').show();
				});
			  return false;
			});
		});
	</script>

  <%# Asynchronous Google Analytics snippet via http://mathiasbynens.be/notes/async-analytics-snippet %>
  <script>
    var _gaq=[['_setAccount','UA-21191360-6'],['_setDomainName','gt.shelby.tv'],['_trackPageview']];
    (function(d,t){var g=d.createElement(t),s=d.getElementsByTagName(t)[0];
    g.src=('https:'==location.protocol?'//ssl':'//www')+'.google-analytics.com/ga.js';
    s.parentNode.insertBefore(g,s)}(document,'script'));
  </script>

</body>
</html>
